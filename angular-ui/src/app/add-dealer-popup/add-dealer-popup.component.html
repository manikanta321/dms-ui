<div class="font dealerPopup">
    <div class=" main" width="900%">
        <div class="container add-dealer-scroll">
            <div class="addUser">
                <mat-icon mat-button class="close-icon" [mat-dialog-close]="true">close</mat-icon>
            </div>
            <div class="head-t">
                <h3 class="addU font">{{dealerAction}} Dealer</h3>
                <br>
                <div class="d-flex">
                    <img src="assets/img/arrow-left-circle-fill.svg"  (click)="prevStepper()"
                        class="addMore-icon" style="width: 24px;margin-left: 760px;" alt="left-arr-btn">



                    <!-- <img src="assets/img/arrow-left-circle-fill.svg" *ngIf="basicInfo" class="addMore-icons"
                        style="width: 24px;margin-left: 760px;" alt="left-arr-btn" (click)="goBack(stepper)"> -->

                    <img src="assets/img/arrow-right-circle-fill.svg" (click)="disableBackbutton()" class="addMore-icon"
                        style="width: 24px; margin-left: 12px;" alt="right-arr-btn">

                </div>

                <mat-stepper labelPosition="bottom" #stepper>
                    <mat-step [stepControl]="firstFormGroup">
                        <form [formGroup]="addAddressDetailsForm">
                            <ng-template matStepLabel class="font ">Basic Information</ng-template>
                            <div class="scr">
                                <div class="headefont">
                                    <h6
                                        style="color: #000000 ;font-size:20px; font-weight: lighter;font-family: 'Gilroy'">
                                        <b>Basic
                                            Information</b>
                                    </h6>
                                </div>

                                <div class="fontcolor">
                                    <div class="row">
                                        <div class="col-3 ">
                                            <label>Name<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="CustomerName"
                                                class="addDelercols form-control" required
                                                placeholder="Enter your name">
                                            <span class="text-danger"
                                                *ngIf="addAddressDetailsFormControl['CustomerName'].touched  && addAddressDetailsFormControl['CustomerName'].errors && addAddressDetailsFormControl['CustomerName'].errors['required']">
                                                Name is required
                                            </span>
                                        </div>
                                        <div class="col-3 ">
                                            <label>Email-ID<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="Email" class="addDelercols form-control"
                                                required placeholder="Enter your Email ID">
                                                <span class="text-danger"
                                                *ngIf="addAddressDetailsFormControl['Email'].touched  && addAddressDetailsFormControl['Email'].errors && addAddressDetailsFormControl['Email'].errors['required']">
                                                Email is required
                                            </span>
                                        </div>
                                        <div class="col-3 ">
                                            <label>Code<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="Code" class="addDelercolss form-control"
                                                required placeholder="Enter your code">
                                                <span class="text-danger"
                                                *ngIf="addAddressDetailsFormControl['Code'].touched && addAddressDetailsFormControl['Code'].errors && addAddressDetailsFormControl['Code'].errors['required']">
                                                Code is required
                                            </span>
                                        </div>
                                        <div class="col-3 " style="margin-left: -6px;">
                                            <label>Website<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="website"
                                                class="addDelercols form-control" required
                                                placeholder="Enter your company website"
                                               >
                                               <span class="text-danger"
                                               *ngIf="addAddressDetailsFormControl['website'].touched  && addAddressDetailsFormControl['website'].errors && addAddressDetailsFormControl['website'].errors['required']">
                                               Website is required
                                           </span>
                                        </div>
                                    </div>
                                    <br>
                                    <div class="row">
                                        <div class="col-3">
                                            <label>Phone No<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="Phoneno"
                                                class="addDelercols form-control" required placeholder="Enter phone no"
                                               >
                                               <span class="text-danger"
                                               *ngIf="addAddressDetailsFormControl['Phoneno'].touched  && addAddressDetailsFormControl['Phoneno'].errors && addAddressDetailsFormControl['Phoneno'].errors['required']">
                                               Phone No is required
                                           </span>
                                        </div>
                                        <div class="col-3">
                                            <label>Company ID</label>
                                            <br>
                                            <input type="text" formControlName="company_id"
                                                class="addDelercolss form-control"
                                                placeholder="Enter your company ID"
                                                >
                                        </div>
                                        <div class="col-6 " style="bottom:13px;right: 6px;">
                                            <label class="otherId">Other Identifer</label>
                                            <br>
                                            <input type="text" formControlName="OtherIdentifier"
                                                class="addDelercols form-control"
                                                placeholder="Enter and select" >
                                            <img src="../assets/img/search.png" class="search">
                                        </div>
                                    </div>
                                    <!-- <div class="row">
                                        <div class="col-4">
                                        </div>
                                        <div class="col-4 ">
                                            <label class="otherId">Other Identifer</label>
                                            <br>
                                            <input type="text" formControlName="OtherIdentifier"
                                                class="addDelercols form-control"
                                                placeholder="Enter and select" >
                                            <img src="../assets/img/search.png" class="search">
                                        </div>
                                        <div class="col-4 ">
                                        </div>
                                    </div> -->
                                </div>
                                <!-- AdminUser -->
                                <ng-template matStepLabel>AdminUser</ng-template>
                                <div class="headefont" style="margin-top:25px;">
                                    <h6
                                        style="color: #000000 ;font-size:20px; font-weight: lighter;font-family: 'Gilroy'">
                                        <b>Admin user</b>
                                    </h6>
                                </div>


                                <div class="col-12">
                                    <div class="row">
                                        <div class="col-4 fontcolor">
                                            <label>User Name<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="UserName"
                                                class="addDelercols form-control" required placeholder="Enter your name"
                                              >
                                              <span class="text-danger"
                                              *ngIf="addAddressDetailsFormControl['UserName'].touched  && addAddressDetailsFormControl['UserName'].errors && addAddressDetailsFormControl['UserName'].errors['required']">
                                              UserName is required
                                          </span>
                                        </div>
                                        <div class="col-4 fontcolor">
                                            <label>Email ID<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="EmailId"
                                                class="addDelercols form-control" required
                                                placeholder="Enter your email ID">
                                                <span class="text-danger"
                                                *ngIf="addAddressDetailsFormControl['EmailId'].touched  && addAddressDetailsFormControl['EmailId'].errors && addAddressDetailsFormControl['EmailId'].errors['required']">
                                                Email ID is required
                                            </span>

                                        </div>
                                        <div class="col-4 fontcolor">
                                            <label>Phone No<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="Mobile"
                                                class="addDelercols form-control" required
                                                placeholder="Enter your phone no" >
                                                <span class="text-danger"
                                                *ngIf="addAddressDetailsFormControl['Mobile'].touched  && addAddressDetailsFormControl['Mobile'].errors && addAddressDetailsFormControl['Mobile'].errors['required']">
                                                Phone No is required
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row secondDiv">
                                        <div class="col-4 " >
                                            <label>First Name<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="FirstName"
                                                class="addDelercols form-control" required
                                                placeholder="Enter your First Name"
                                               >
                                               <span class="text-danger"
                                               *ngIf="addAddressDetailsFormControl['FirstName'].touched  && addAddressDetailsFormControl['FirstName'].errors && addAddressDetailsFormControl['FirstName'].errors['required']">
                                               First Name is required
                                           </span>
                                        </div>
                                        <div class="col-4">
                                            <label>Last Name<span>*</span></label>
                                            <br>
                                            <input type="text" formControlName="lastName"
                                                class="addDelercols form-control" required
                                                placeholder="Enter your Last Name" >
                                                <span class="text-danger"
                                                *ngIf="addAddressDetailsFormControl['lastName'].touched  && addAddressDetailsFormControl['lastName'].errors && addAddressDetailsFormControl['lastName'].errors['required']">
                                                Last Name is required
                                            </span>
                                        </div>
                                        <div class="col-4">
                                            <label>Status<span>*</span></label>
                                            <br>
                                            <select class="status-class" formControlName="StatusId" name="status"
                                                placeholder="Select Status">
                                                <option value="" selected hidden>Select status</option>
                                                <option *ngFor="let option of statusList" [value]="option.statusId">
                                                    {{option.statusName}}
                                                </option>
                                            </select>
                                            <span class="text-dangers"
                                            *ngIf="addAddressDetailsFormControl['StatusId'].touched  && addAddressDetailsFormControl['StatusId'].errors && addAddressDetailsFormControl['StatusId'].errors['required']">
                                            Status is required
                                        </span>
                                        </div>
                                    </div>
                                </div>
                                <!-- Address -->

                                <div class="col-12" style="margin-top:25px;">
                                    <div class="row">
                                        <div class="col-11">
                                            <div class="headefont">
                                                <h6
                                                    style="color: #000000 ;font-size:20px; font-weight: lighter;font-family: 'Gilroy'">
                                                    <b>Addresses</b>
                                                </h6>
                                            </div>
                                        </div>
                                        <div class="col-1">
                                            <mat-icon class="addMore-icon"
                                                (click)=addAddressForm()>add_circle</mat-icon>
                                        </div>
                                    </div>


                                    <div formArrayName="addresscount">

                                        <div class="row" *ngFor="let quantity of addresscount().controls; let i=index"
                                            [formGroupName]="i">
                                            <div class="col-1">
                                                <label *ngIf="i == 0">Type<span>*</span></label>
                                                <br>
                                                <select class="addDelercols addtype" formControlName="AddressTypeId"
                                                    name="status" placeholder="select">
                                                    <option value="" selected hidden>Type</option>
                                                    <option value="7">Billing</option>
                                                    <option value="6">Shipping</option>
                                                </select>

                                            </div>

                                            <div class="col-2">
                                                <label *ngIf="i == 0">Consignee Name<span>*</span></label>
                                                <br>
                                                <input type="text" placeholder="Enter" formControlName="ConsigneeName" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].ConsigneeName"
                                                    class="addDelercols addname">
                                            </div>

                                            <div class="col-1">
                                                <label *ngIf="i == 0">Tax<span>*</span></label>
                                                <br>
                                                <select #teams  class="addDelercols addtax" aria-label=".form-select-lg example" formControlName="Taxid"   [(ngModel)]="addAddressDetailsForm.value.addresscount[i].Taxid"
                                                
                (change)="selectedTax(teams.value);">
                <option value="" selected hidden>Select</option>
                <option style="height: 900px;" *ngFor="let product of taslistArray" 
                  value="{{product.taxTemplateId}}">
                  <p>{{product.taxTemplateName}}</p>
                </option>
                                                </select>
                                            </div>

                                            <div class="col-2">
                                                <label *ngIf="i == 0">Address Line<span>*</span></label>
                                                <br>
                                                <input type="text" placeholder="Enter" formControlName="AddressLine1"
                                                    class="addDelercols addadress" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].AddressLine1">
                                                <input type="text" placeholder="Enter" formControlName="AddressLine2"
                                                    class="addDelercols addadressLine1" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].AddressLine2">
                                            </div>

                                            <div class="col-1">
                                                <label *ngIf="i == 0">Country<span>*</span></label>
                                                <br>
                                                <input type="text" placeholder="Enter" formControlName="CountryName" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].CountryName"
                                                    class="addDelercols addcountry">
                                            </div>

                                            <div class="col-1">
                                                <label *ngIf="i == 0">State<span>*</span></label>
                                                <br>
                                                <input type="text" placeholder="Enter" formControlName="StateName" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].StateName"
                                                    class="addDelercols aastate">
                                            </div>

                                            <div class="col-2">
                                                <label *ngIf="i == 0">City & Zip<span>*</span></label>
                                                <br>
                                                <input type="text" placeholder="Enter City" formControlName="CityName" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].CityName"
                                                    class="addDelercols addcity">
                                                <input type="text" placeholder="Enter Zip" formControlName="ZipCode" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].ZipCode"
                                                    class="addDelercols addzip">
                                            </div>

                                            <div class="col-1">
                                                <label *ngIf="i == 0">Phone<span>*</span></label>
                                                <br>
                                                <input type="text" placeholder="Enter" formControlName="Telephone" [(ngModel)]="addAddressDetailsForm.value.addresscount[i].Telephone"
                                                    class="addDelercols addphone">
                                            </div>


                                            <div class="col-1">
                                                <label><span></span></label>
                                                <mat-icon (click)="removeQuantity(i)"
                                                    class="col-2 remove-mat-icon delete-icon remove-address"
                                                    [ngClass]="{ 'removeCircle': i>1 ,'removeCircle1': i==3 }"
                                                    *ngIf="i >= 0 ">remove_circle
                                                </mat-icon>
                                            </div>



                                        </div>

                                    </div>


                                    <p  class="form-row">

                                        <mat-checkbox      [checked]="completed" (click)=Checked() >
                                            Shipping information is same as
                                            billing
                                            information </mat-checkbox>
                                    </p>

                                </div>


                                <div class="row">
                                    <div class="col-5">
                                    </div>
                                    <div class="col-3">
                                        <button (click)="saveDealerData()" 
                                            class="btn btn-primary btn-block submitbtn save-btn" [disabled]="!addAddressDetailsForm.valid">Next</button>
                                            <span *ngIf="!addAddressDetailsForm.valid">*Please fill required fields</span>
                                    </div>
                                    <div class="col-4">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </mat-step>

                    <!-- geography -->

                    <mat-step [stepControl]="secondFormGroup">
                        <form [formGroup]="gepGraphiesFormGroup">
                            <ng-template matStepLabel> Geographies</ng-template>
                            <div class="heading">
                                <h6 class="Geo-headerlabel"><b>Geographies</b></h6>
                            </div>

                            <div class="horizontal-scroll">
                                <div class="horizontal-scroll__item"
                                    *ngFor="let item of geoGraphyFullData;let i =index; ">
                                    <div class="geo-grid">
                                        <div class="row grid-heading">
                                            <div class="col-sm-10">
                                                <p><span class="country">{{item.geographyHierarchyName}}</span>
                                                    <span class="ml-1" *ngIf="item.primaryGeographyAssociation =='Y'">
                                                        <img src="assets/img/double-blue-tick.svg"
                                                            alt="double-blue-tick"> </span>
                                                </p>

                                            </div>

                                        </div>
                                        <mat-card class="mat-card mat-focus-indicator mat-card-content scroll">
                                            <mat-card-content class="mat-card-content">
                                                <div *ngIf="item.allOtherGeography">
                                                    <div class="d-flex "
                                                        *ngFor="let geoItem of item.allOtherGeography; ">
                                                        <div class="geography-item"
                                                            [ngStyle]="{'background':isItemSelected(item,geoItem) ? colorsList[i].secondaryColor.background : colorsList[i].primaryColor.background, 'color':isItemSelected(item, geoItem) ? colorsList[i].secondaryColor.color : colorsList[i].primaryColor.color,'border': '1px solid ' + colorsList[i].primaryColor.background }"
                                                            (click)="selectGeoGraphy(geoItem,(i +1))">
                                                            <div class="title"> {{geoItem.geographyName}}
                                                                <strong
                                                                    *ngIf="geoItem.selectedCount != null && geoItem.selectedCount != undefined">({{
                                                                    geoItem.selectedCount}} / {{
                                                                    geoItem.countOfDefault}})</strong>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </mat-card-content>
                                        </mat-card>
                                    </div>
                                </div>

                            </div>






                            <div class="row">
                                <div class="col-3">

                                </div>
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-1"></div>
                                        <div class="col-5">
                                            <button [disabled]="!addAddressDetailsForm.valid" class="btn btn-primary btn-block submitbtn save-btn"
                                                *ngIf="dealerAction!=='Edit'"
                                                (click)="saveGeographiesList()">Save</button>
                                            <button *ngIf="dealerAction == 'Edit'"
                                                class="btn btn-primary btn-block submitbtn save-btn"
                                                (click)="EditGeographiesList()">Save</button>
                                                <span *ngIf="!addAddressDetailsForm.valid">*Please fill required fields</span>
                                        </div>
                                        <div class="col-5">
                                            <button class="btn btn-primary btn-block submitbtn cancel-btn"
                                                [mat-dialog-close]="true">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">

                                </div>
                            </div>

                        </form>
                    </mat-step>

                </mat-stepper>
            </div>
        </div>
    </div>
</div>